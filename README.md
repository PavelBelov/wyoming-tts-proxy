# Wyoming TTS Proxy

**–ö—ç—à–∏—Ä—É–µ–º—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –¥–ª—è Wyoming TTS —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Yandex.TTS –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∞—É–¥–∏–æ—Ä–µ–¥–µ—Ñ–∏–Ω–∏—Ü–∏–π**

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–æ–∫—Å–∏-–ø—Ä–æ—Å–ª–æ–π–∫—É –º–µ–∂–¥—É Home Assistant (–∏–ª–∏ –ª—é–±—ã–º –∫–ª–∏–µ–Ω—Ç–æ–º Wyoming-–ø—Ä–æ—Ç–æ–∫–æ–ª–∞) –∏ —Ä–µ–∞–ª—å–Ω—ã–º Wyoming TTS-—Å–µ—Ä–≤–µ—Ä–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, **piper**).
–û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äî –æ–±–µ—Å–ø–µ—á–∏—Ç—å **–≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ä–µ—á–∏** —á–µ—Ä–µ–∑ **Yandex.TTS** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ–¥–º–µ–Ω—ã –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ –∏ –±–µ—Å—à–æ–≤–Ω–æ–≥–æ fallback-—Ä–µ–∂–∏–º–∞.

---

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

**1. –ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å Wyoming TTS.**
–ü—Ä–æ–∫—Å–∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ Wyoming-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ä–µ—á–∏ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π TTS-—Å–µ—Ä–≤–µ—Ä.

**2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—É–¥–∏–æ—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ —Ç–µ–∫—Å—Ç—É**
–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ —Ç–µ–∫—Å—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∞. –ï—Å–ª–∏ –∞—É–¥–∏–æ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî –æ–Ω–æ —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è.
2. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø—Ä–æ–∫—Å–∏ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å:
   * –∫ **—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É Wyoming-—Å–µ—Ä–≤–µ—Ä—É** (–±—ã—Å—Ç—Ä—ã–π, –Ω–æ –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ),
   * **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ** –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –æ–∑–≤—É—á–∫—É –≤ **Yandex.TTS**, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ—ë –≤ –∫—ç—à –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.

**3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤** 
–ú–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Å–≤—è–∑–∞—Ç—å —Ç–µ–∫—Å—Ç ‚Üí –∞—É–¥–∏–æ—Ñ–∞–π–ª –∏ —Ç–µ–º —Å–∞–º—ã–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–∑–≤—É—á–∫—É –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ—Ä–∞–∑.
–ù–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–º–µ–Ω–∏—Ç—å ¬´–û–±—Ä–∞—â–µ–Ω–∏–µ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ¬ª –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–≤—É–∫.

**4. –ù–∞–¥—ë–∂–Ω—ã–π fallback**
–ï—Å–ª–∏ Yandex.TTS –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–æ—à–∏–±–∫–∞ —Å–µ—Ç–∏, –∫–≤–æ—Ç—ã, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞) ‚Äî Home Assistant –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ–ª—É—á–∏—Ç –±–∞–∑–æ–≤—É—é –æ–∑–≤—É—á–∫—É –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ Wyoming-—Å–µ—Ä–≤–µ—Ä–∞.

**5. –≠–∫–æ–Ω–æ–º–∏—è —Å—Ä–µ–¥—Å—Ç–≤ Yandex.Cloud**
–ö–∞–∂–¥—ã–π —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑**, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è.
–î–ª—è Home Assistant, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å—Ç–æ –ø—Ä–æ–∏–∑–Ω–æ—Å–∏—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ñ—Ä–∞–∑—ã, –∫—ç—à —Ä–µ–∑–∫–æ —Å–Ω–∏–∂–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É.

**6. Webhook-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è Home Assistant**
–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ–≥–æ –∞—É–¥–∏–æ –∏–∑ Yandex.TTS –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤–µ–±—Ö—É–∫.
–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç Home Assistant **—Å–±—Ä–∞—Å—ã–≤–∞—Ç—å —Å–≤–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∞—É–¥–∏–æ–∫—ç—à** –∏ —Å—Ä–∞–∑—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –æ–∑–≤—É—á–∫—É.

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```
data/
 ‚îú‚îÄ‚îÄ config.json
 ‚îú‚îÄ‚îÄ cache/         ‚Üê –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫—ç—à–∏—Ä—É–µ–º—ã–µ –∞—É–¥–∏–æ
 ‚îî‚îÄ‚îÄ def/     ‚Üê –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
```

*–ü–∞–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.*

–ü—Ä–∏–º–µ—Ä `config.json`:

```json
{
    "endpoint": "tcp://0.0.0.0:10200",
    "parent": "tcp://piper:10200",
    "webhook": "http://homeassistant:8123/api/webhook/<MyHook>",
    "yandex": {
        "token": "<API-TOKEN>",
        "address": "tts.api.cloud.yandex.net:443",
        "voice": "yulduz_ru",
        "role": "neutral",
        "speed": 1.2
    }
}
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–æ–ª–µ             | –û–ø–∏—Å–∞–Ω–∏–µ                                                                      |
| ---------------- | ----------------------------------------------------------------------------- |
| `endpoint`       | –ê–¥—Ä–µ—Å, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Å–∞–º –ø—Ä–æ–∫—Å–∏ (Wyoming endpoint).                   |
| `parent`         | –ê–¥—Ä–µ—Å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ Wyoming TTS —Å–µ—Ä–≤–µ—Ä–∞ (–æ–±—ã—á–Ω–æ piper).                       |
| `webhook`        | –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π URL –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è Home Assistant –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∞—É–¥–∏–æ. |
| `yandex.token`   | API-–∫–ª—é—á Yandex.Cloud.                                                        |
| `yandex.address` | gRPC-endpoint Yandex.TTS.                                                     |
| `yandex.voice`   | –í—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–ª–æ—Å.                                                              |
| `yandex.role`    | –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ä–æ–ª—å.                                                           |
| `yandex.speed`   | –°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ—á–∏.                                                                |

### –ü–æ–¥–º–µ–Ω–∞ –∞—É–¥–∏–æ

–ß—Ç–æ–±—ã –∑–∞–º–µ–Ω–∏—Ç—å –æ–∑–≤—É—á–∫—É —Ç–µ–∫—Å—Ç–∞:

1. –ü–æ–ª–æ–∂–∏—Ç–µ –∞—É–¥–∏–æ (wav) –≤ `def/`
2. –í `_data.json` –≤ —ç—Ç–æ–π –∂–µ –ø–∞–ø–∫–µ –¥–æ–±–∞–≤—Ç—å —Å—Ç—Ä–æ–∫—É –∫–ª—é—á<-> –∑–Ω–∞—á–µ–Ω–∏–µ, –≥–¥–µ –∫–ª—é—á - —Ñ—Ä–∞–∑–∞, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–º—è —Ñ–∞–π–ª–∞ (wav)

---

## üê≥ –ó–∞–ø—É—Å–∫ –≤ Docker

```bash
docker run -d \
  --name wyoming-tts-proxy \
  -p 10200:10200 \
  -v /path/to/data:/app/data \
  wyoming-tts-proxy:latest
```

## üß™ –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å —Ç–µ–∫—Å—Ç–∞ ¬´–ü—Ä–∏–≤–µ—Ç!¬ª

1. –ü—Ä–æ–∫—Å–∏ –∏—â–µ—Ç –≤ `def/` ‚Üí –Ω–µ—Ç
2. –ü—Ä–æ–∫—Å–∏ –∏—â–µ—Ç –≤ `cache/` ‚Üí –Ω–µ—Ç
3. –ü—Ä–æ–∫—Å–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π Wyoming ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±—ã—Å—Ç—Ä—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
4. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç Yandex.TTS ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫—ç—à
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook –≤ Home Assistant

### –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å ¬´–ü—Ä–∏–≤–µ—Ç!¬ª

1. –ù–∞—Ö–æ–¥–∏—Ç –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ –∫—ç—à–µ
2. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
